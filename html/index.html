<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>DASER</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.2/css/all.css" integrity="sha384-/rXc/GQVaYpyDdyxK+ecHPVYJSN9bmVFBvjA/9eOB+pb3F2w2N6fc5qB9Ew5yIns"
        crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

    <header>
        <span id="daser">DASER</span>
    </header>

    <div id="container">

        <div id="header-container">
            <div id="alert">
                <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
                <strong>Error!</strong> Invalid mysql command.
            </div>
            <div id="alert2">
                <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
                <strong>Invalid file.</strong> Please upload a .txt extension file with sql commands separated by /.
            </div>
            <div id="alert3">
                <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
                <strong>Invalid table name.</strong> Please use only letters.
            </div>
            <div id="alert4">
                <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
                <strong>Invalid column name.</strong> Please use only letters.
            </div>
            <div id="alert5">
                <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
                <strong>Invalid datatype value.</strong> Datatype value is only for Char and Varchar.
            </div>
            <div id="alert6">
                <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
                <strong>Invalid datatype value.</strong> Datatype value should not be empty and the value should be between 1 and
                255 for Char and Varchar.
            </div>
            <div id="alert7">
                <span class="closebtn" onclick="this.parentElement.style.display='none'">&times;</span>
                You must provide data.
            </div>
            <div id="alert8">
                <span class="closebtn" onclick="this.parentElement.style.display='none'">&times;</span>
                Warning! You can't go back, you will lose your data.
            </div>

            <input type="text" id="sql-command" placeholder="SQL COMMAND" />
            <button class="enter-button tooltip" onclick="runSQL()">
                <span class="tooltiptext">Run command</span>
                <i class="fas fa-play"></i>
            </button>
            <button class="import-button tooltip" id="custom-button">
                <span class="tooltiptext">Import SQL</span>
                <i class="fas fa-file-import"></i>
            </button>
        </div>

        <div id="container-body">
            <div class="sql-button-container tooltip">
                <span class="tooltiptext">Create table</span>
                <button class="sql-buttons" onclick="displayCreateTable();">
                    <i class="far fa-window-maximize"></i>
                </button>
            </div>
            <div class="sql-button-container tooltip">
                <span class="tooltiptext">Alter table</span>
                <button class="sql-buttons" onclick="displayAlterTable();">
                    <i class="fas fa-edit"></i>
                </button>
            </div>
            <div id="createTableWindow">
                <div id="createTableWindow-header">
                    <p>CREATE TABLE</p>
                    <button id="close-button" onclick="closePopUp(event);ResetTheCreateTablePopup();">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div id="pop-up-body">
                    <label> Table name
                        <br>
                        <input type="text" id="table-name" pattern="[A-Z]+" title="Use only letters" />
                    </label>
                    <br>
                    <br>
                    <div class="table-property">
                        <div> Column name
                            <input type="text" pattern="[A-Z]+" title="Use only letters" />
                        </div>
                        <div> Datatype
                            <select>
                                <option value="TINYINT">TINYINT</option>
                                <option value="SMALLINT">SMALLINT</option>
                                <option value="MEDIUMINT">MEDIUMINT</option>
                                <option value="BIGINT">BIGINT</option>
                                <option value="INT">INT</option>
                                <option value="DATE">DATE</option>
                                <option value="DATETIME">DATETIME</option>
                                <option value="TIMESTAMP">TIMESTAMP</option>
                                <option value="TIME">TIME</option>
                                <option value="TINYTEXT">TINYTEXT</option>
                                <option value="MEDIUMTEXT">MEDIUMTEXT</option>
                                <option value="LONGTEXT">LONGTEXT</option>
                                <option value="TEXT">TEXT</option>
                                <option value="TINYBLOB">TINYBLOB</option>
                                <option value="MEDIUMBLOB">MEDIUMBLOB</option>
                                <option value="LONGBLOB">LONGBLOB</option>
                                <option value="BLOB">BLOB</option>
                                <option value="ENUM">ENUM</option>
                                <option value="CHAR">CHAR</option>
                                <option value="VARCHAR">VARCHAR</option>
                            </select>
                        </div>
                        <div> Datatype value
                            <input type="text" pattern="[0-9]+" title="Use only digits" />
                        </div>
                        <div>
                            <p>Not Null</p>
                            <input type="checkbox" class="checkbox" />
                        </div>
                    </div>
                </div>
                <div id="add-button-pop-up">
                    <button id="add-btn">+</button>
                    <button id="run-btn">></button>
                </div>
            </div>

            <div id="alterTableWindow">
                <div id="alterTableWindow-header">
                    <p>ALTER TABLE</p>
                    <button id="close-button" onclick="closePopUp(event)">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div id="pop-up-body">
                    <label> Table name
                        <br>
                        <select id="table-selection" onchange="renderColumnSelection();">
                            <option value="none">Choose a table</option>
                        </select>
                    </label>
                    <br>
                    <br>
                    <label> Column name
                        <br>
                        <select id="column-selection">
                            <option value="none">Choose a column</option>
                        </select>
                    </label>

                    <label> Data type
                        <br>
                        <select id="datatype-selection">
                            <option value="none">Choose datatype</option>
                            <option value="TINYINT">TINYINT</option>
                            <option value="SMALLINT">SMALLINT</option>
                            <option value="MEDIUMINT">MEDIUMINT</option>
                            <option value="BIGINT">BIGINT</option>
                            <option value="INT">INT</option>
                            <option value="DATE">DATE</option>
                            <option value="DATETIME">DATETIME</option>
                            <option value="TIMESTAMP">TIMESTAMP</option>
                            <option value="TIME">TIME</option>
                            <option value="TINYTEXT">TINYTEXT</option>
                            <option value="MEDIUMTEXT">MEDIUMTEXT</option>
                            <option value="LONGTEXT">LONGTEXT</option>
                            <option value="TEXT">TEXT</option>
                            <option value="TINYBLOB">TINYBLOB</option>
                            <option value="MEDIUMBLOB">MEDIUMBLOB</option>
                            <option value="LONGBLOB">LONGBLOB</option>
                            <option value="BLOB">BLOB</option>
                            <option value="ENUM">ENUM</option>
                            <option value="CHAR">CHAR</option>
                            <option value="VARCHAR">VARCHAR</option>
                        </select>
                    </label>
                    <br>
                    <label> New column name
                        <br>
                        <input type="text" id="new-column-name" />
                    </label>
                    <div id="submit-button-pop-up">
                        <button id="submit-btn" onclick="changeColumnName(event);">Submit</button>
                    </div>
                </div>
            </div>

            <div id="fkTableWindow">
                <div id="fkTableWindow-header">
                    <p>CREATE FOREIGN KEY</p>
                    <button id="close-button" onclick="closePopUp(event)">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div id="pop-up-body">
                    <label> Table name
                        <br>
                        <select id="table-selection-fk" onchange="renderColumnSelectionFk();">
                            <option value="none">Choose a table</option>
                        </select>
                    </label>
                    <div id="first-fk-columns-container">
                    </div>
                    <label> Table name
                        <br>
                        <select id="table-selection-fk2" onchange="renderColumnSelectionFk2();">
                            <option value="none">Choose a table</option>
                        </select>
                    </label>
                    <div id="second-fk-columns-container">
                    </div>

                    <div id="submit-button-pop-up">
                        <button id="submit-btn-fk" onclick="requestCreateForeignKey();">Submit</button>
                    </div>
                </div>
            </div>

            <div id="deleteTableWindow">
                <div id="deleteTableWindow-header">
                    <p>DELETE TABLE</p>
                    <button id="close-button" onclick="closePopUp(event)">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div id="pop-up-body">
                    <label> Table name
                        <br>
                        <select id="table-delete-selection" onchange="renderReferencedTables()">
                            <option value="none">Choose a table</option>
                        </select>
                    </label>
                    <div id="referencedTables"></div>
                    <div id="submit-button-pop-up">
                        <button id="delete-btn" onclick="requestDelete()">Delete</button>
                    </div>
                    <div id="delete-pop-up-window">
                        <p>Warning! The following referenced tables will be also deleted. Are you sure ?
                        </p>
                        <button onclick="confirmDelete()">Confirm</button>
                        <button onclick="cancelDelete()">Cancel</button>
                    </div>
                </div>
            </div>
            <div id="infoWindow">
                <div id="infoWindow-header">
                    <p>INFO</p>
                    <button id="close-button" onclick="closePopUp(event)">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div id="infoWindow-text-container">
                    <!-- adaug infoooo despre aplicatie^^ -->
                    <h1>Si quieres saber algo sobre esta aplicacion, porfavor vete a la mierda ^_^!!!!</h1>
                    <h1>Si quieres saber algo sobre esta aplicacion, porfavor vete a la mierda ^_^!!!!</h1>
                    <h1>Si quieres saber algo sobre esta aplicacion, porfavor vete a la mierda ^_^!!!!</h1>
                    <h1>Si quieres saber algo sobre esta aplicacion, porfavor vete a la mierda ^_^!!!!</h1>
                    <h1>Si quieres saber algo sobre esta aplicacion, porfavor vete a la mierda ^_^!!!!</h1>
                </div>
            </div>

            <div class="sql-button-container tooltip">
                <span class="tooltiptext">Create foreign key</span>
                <button class="sql-buttons" onclick="displayFkWindow()">
                    <i class="fas fa-project-diagram"></i>
                </button>
            </div>

            <div class="sql-button-container tooltip">
                <span class="tooltiptext">Delete</span>
                <button class="sql-buttons" onclick="displayDeleteWindow()">
                    <i class="fas fa-trash-alt"></i>
                </button>
            </div>

            <div class="sql-button-container tooltip">
                <span class="tooltiptext">Zoom in</span>
                <button class="sql-buttons" onclick="zoomIn()">
                    <i class="fas fa-search-plus"></i>
                </button>
            </div>

            <div class="sql-button-container tooltip">
                <span class="tooltiptext">Zoom out</span>
                <button class="sql-buttons" onclick="zoomOut()">
                    <i class="fas fa-search-minus"></i>
                </button>
            </div>

            <div class="sql-button-container-right tooltip">
                <span class="tooltiptext">Export SQL commands</span>
                <button class="sql-buttons" onclick="exportSqlCommands()">
                    <i class="fas fa-file-code"></i>
                </button>
            </div>

            <div class="sql-button-container-right tooltip">
                <span class="tooltiptext">Export as SVG</span>
                <button class="sql-buttons" onclick="saveSvg('schema-svg','schema.svg');">
                    <i class="fas fa-image"></i>
                </button>
            </div>

            <div class="sql-button-container-right tooltip">
                <span class="tooltiptext">Info</span>
                <button class="sql-buttons" onclick="displayInfoWindow()">
                    <i class="fas fa-info-circle"></i>
                </button>
            </div>
        </div>

        <svg id="schema-svg" width="calc(100% - 6px)" height="720" style="background-color:#1e4f60;">
            <svg id="group-svg" x="0" y="0" style="overflow: visible;">
                <g id="group-svg-objects">
                </g>
            </svg>
        </svg>


    </div>
    <script src="../javascript/svg-transforms.js"></script>
    <script src="../javascript/svg-zoom.js"></script>
    <script src="../javascript/svg-export.js"></script>
    <script type="module" src="../javascript/createTablePopup.js"></script>
    <script type="module" src="../javascript/buttonsFunctionality.js"></script>
    <script type="module" src="../javascript/displayWindows.js"></script>
    <script type="module" src="../javascript/script.js"></script>
    <script type="module" src="../javascript/importSql.js"></script>
    <script type="text/javascript">
        window.onbeforeunload = function() {
            return "You will lost your data";
        } 
    </script>
    <input type="file" id="real-file" accept="text/plain" hidden="hidden" />
</body>

</html>