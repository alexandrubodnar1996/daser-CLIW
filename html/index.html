<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>DASER</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.2/css/all.css" integrity="sha384-/rXc/GQVaYpyDdyxK+ecHPVYJSN9bmVFBvjA/9eOB+pb3F2w2N6fc5qB9Ew5yIns"
        crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

    <header>
        <span id="daser">DASER</span>
    </header>

    <div id="container">

        <div id="header-container">
            <div id="alert">
                <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
                <strong>Error!</strong> Invalid mysql command.
            </div>
            <div id="alert2">
                <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
                <strong>Invalid file.</strong> Please upload a .txt extension file with sql commands separated by /.
            </div>
            <input type="text" id="sql-command" placeholder="SQL COMMAND" />
            <button class="enter-button tooltip" onclick="runSQL()">
                <span class="tooltiptext">Run command</span>
                <i class="fas fa-play"></i>
            </button>
            <button class="import-button tooltip" id="custom-button">
                <span class="tooltiptext">Import SQL</span>
                <i class="fas fa-file-import"></i>
            </button>
        </div>

        <div id="container-body">
            <div class="sql-button-container tooltip">
                <span class="tooltiptext">Create table</span>
                <button class="sql-buttons" onclick="displayCreateTable();">
                    <i class="far fa-window-maximize"></i>
                </button>
            </div>
            <div class="sql-button-container tooltip">
                <span class="tooltiptext">Alter table</span>
                <button class="sql-buttons" onclick="displayAlterTable();">
                    <i class="fas fa-edit"></i>
                </button>
            </div>
            <div id="createTableWindow">
                <div id="createTableWindow-header">
                    <p>CREATE TABLE</p>
                    <button id="close-button" onclick="closePopUp(event)">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div id="pop-up-body">
                    <label> Table name
                        <br>
                        <input type="text" id="table-name" pattern="[A-Z]+" title="Use only letters"/>
                    </label>
                    <br>
                    <br>
                    <div class="table-property">
                        <div> Column name
                            <input type="text" pattern="[A-Z]+" title="Use only letters"/>
                        </div>
                        <div> Datatype
                            <select>
                                <option value="tinyint">TINYINT</option>
                                <option value="smallint">SMALLINT</option>
                                <option value="mediumint">MEDIUMINT</option>
                                <option value="bigint">BIGINT</option>
                                <option value="int">INT</option>
                                <option value="date">DATE</option>
                                <option value="datetime">DATETIME</option>
                                <option value="timestamp">TIMESTAMP</option>
                                <option value="time">TIME</option>
                                <option value="tinytext">TINYTEXT</option>
                                <option value="mediumtext">MEDIUMTEXT</option>
                                <option value="longtext">LONGTEXT</option>
                                <option value="text">TEXT</option>
                                <option value="tinyblob">TINYBLOB</option>
                                <option value="mediumblob">MEDIUMBLOB</option>
                                <option value="longblob">LONGBLOB</option>
                                <option value="blob">BLOB</option>
                                <option value="enum">ENUM</option>
                                <option value="char">CHAR</option>
                                <option value="varchar">VARCHAR</option>
                            </select>
                        </div>
                        <div> Datatype value
                            <input type="text" pattern="[0-9]+" title="Use only digits"/>
                        </div>
                    </div>
                </div>
                <div id="add-button-pop-up">
                    <button id="add-btn">+</button>
                </div>
                <div id="run-button-pop-up">
                    <button id="run-btn">></button>
                </div>
            </div>

            <div id="alterTableWindow">
                <div id="alterTableWindow-header">
                    <p>ALTER TABLE</p>
                    <button id="close-button" onclick="closePopUp(event)">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div id="pop-up-body">
                    <label> Table name
                        <br>
                        <select id="table-selection" onchange="renderColumnSelection();">
                            <option value="none">Choose a table</option>
                        </select>
                    </label>
                    <br>
                    <br>
                    <label> Column name
                        <br>
                        <select id="column-selection">
                            <option value="none">Choose a column</option>
                        </select>
                    </label>

                    <label> Data type
                        <br>
                        <select id="datatype-selection">
                            <option value="INT">INT</option>
                            <option value="VARCHAR">VARCHAR</option>
                            <option value="CHAR">CHAR</option>
                            <option value="BOOL">BOOL</option>
                            <option value="DATE">DATE</option>
                        </select>
                    </label>
                    <br>
                    <label> New column name
                        <br>
                        <input type="text" id="new-column-name" />
                    </label>
                    <div id="submit-button-pop-up">
                        <button id="submit-btn" onclick="changeColumnName(event);">Submit</button>
                    </div>
                </div>
            </div>
            <div id="deleteTableWindow">
                <div id="deleteTableWindow-header">
                    <p>Delete TABLE</p>
                    <button id="close-button" onclick="closePopUp(event)">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div id="pop-up-body">
                    <label> Table name
                        <br>
                        <select id="table-delete-selection" onchange="renderReferencedTables()">
                            <option value="none">Choose a table</option>
                        </select>
                    </label>
                    <div id="referencedTables"></div>
                    <div id="submit-button-pop-up">
                        <button id="delete-btn" onclick="requestDelete()">Delete</button>
                    </div>
                    <div id="delete-pop-up-window">
                        <p>Warning! The following referenced tables will be also deleted. Are you sure ?
                        </p>
                        <button onclick="confirmDelete()">Confirm</button>
                        <button onclick="cancelDelete()">Cancel</button>
                    </div>
                </div>
            </div>


            <div class="sql-button-container tooltip">
                <span class="tooltiptext">Create foreign key</span>
                <button class="sql-buttons">
                    <i class="fas fa-project-diagram"></i>
                </button>
            </div>

            <div class="sql-button-container tooltip">
                <span class="tooltiptext">Delete</span>
                <button class="sql-buttons" onclick="displayDeleteWindow()">
                    <i class="fas fa-trash-alt"></i>
                </button>
            </div>

            <div class="sql-button-container tooltip">
                <span class="tooltiptext">Zoom in</span>
                <button class="sql-buttons" onclick="zoomIn()">
                    <i class="fas fa-search-plus"></i>
                </button>
            </div>

            <div class="sql-button-container tooltip">
                <span class="tooltiptext">Zoom out</span>
                <button class="sql-buttons" onclick="zoomOut()">
                    <i class="fas fa-search-minus"></i>
                </button>
            </div>

            <div class="sql-button-container-right tooltip">
                <span class="tooltiptext">Export SQL commands</span>
                <button class="sql-buttons" onclick="exportSqlCommands()">
                    <i class="fas fa-file-code"></i>
                </button>
            </div>

            <div class="sql-button-container-right tooltip">
                <span class="tooltiptext">Export as SVG</span>
                <button class="sql-buttons" onclick="saveSvg('schema-svg','schema.svg');">
                    <i class="fas fa-image"></i>
                </button>
            </div>

            <div class="sql-button-container-right tooltip">
                <span class="tooltiptext">Info</span>
                <button class="sql-buttons">
                    <i class="fas fa-info-circle"></i>
                </button>
            </div>
        </div>

        <svg id="schema-svg" width="calc(100% - 6px)" height="720" style="background-color:#1e4f60;">
            <svg id="group-svg" x="0" y="0" style="overflow: visible;">
                <g id="group-svg-objects">
                    <!--<rect x="390" y="285" rx="10" ry="10" width="300" height="150"  style="fill:#FFF;stroke:#AAA;stroke-width:2;" />

                    <rect x="750" y="400" rx="10" ry="10" width="300" height="100" style="fill:#FFF;stroke:#AAA;stroke-width:2;" />

                    <rect x="40" y="450" rx="10" ry="10" width="300" height="125" style="fill:#FFF;stroke:#AAA;stroke-width:2;" />

                    <line x1="389" y1="360" x2="190" y2="360" style="stroke:#FFF;stroke-width:4" />
                    <line x1="190" y1="358" x2="190" y2="449" style="stroke:#FFF;stroke-width:4" />

                    <line x1="691" y1="360" x2="900" y2="360" style="stroke:#FFF;stroke-width:4" />
                    <line x1="900" y1="358" x2="900" y2="399" style="stroke:#FFF;stroke-width:4" />

                    <text x="540" y="305" alignment-baseline="middle" text-anchor="middle" font-family="sans-serif" fill="#AAA">STUDENT</text>

                    <text x="420" y="345" font-family="sans-serif" fill="#BABAC1">Id</text>

                    <text x="420" y="365" font-family="sans-serif" fill="#BABAC1">Nume</text>

                    <text x="420" y="385" font-family="sans-serif" fill="#BABAC1">Nr_Matricol</text>

                    <text x="420" y="405" font-family="sans-serif" fill="#BABAC1">An</text>

                    <text x="560" y="345" font-family="sans-serif" fill="#BABAC1">int</text>

                    <text x="560" y="365" font-family="sans-serif" fill="#BABAC1">varchar(64)</text>

                    <text x="560" y="385" font-family="sans-serif" fill="#BABAC1">varchar(64)</text>

                    <text x="560" y="405" font-family="sans-serif" fill="#BABAC1">int</text>

                    <text x="190" y="470" alignment-baseline="middle" text-anchor="middle" font-family="sans-serif" fill="#AAA">NOTE</text>

                    <text x="70" y="505" font-family="sans-serif" fill="#BABAC1">Id</text>

                    <text x="70" y="525" font-family="sans-serif" fill="#BABAC1">Nota</text>

                    <text x="70" y="545" font-family="sans-serif" fill="#BABAC1">Stud_Nr_Matricol</text>

                    <text x="210" y="505" font-family="sans-serif" fill="#BABAC1">int</text>

                    <text x="210" y="525" font-family="sans-serif" fill="#BABAC1">varchar(64)</text>

                    <text x="210" y="545" font-family="sans-serif" fill="#BABAC1">varchar(64)</text>

                    <text x="900" y="420" alignment-baseline="middle" text-anchor="middle" font-family="sans-serif" fill="#AAA">CURSURI</text>

                    <text x="780" y="455" font-family="sans-serif" fill="#BABAC1">Id</text>

                    <text x="780" y="475" font-family="sans-serif" fill="#BABAC1">Titlu_curs</text>

                    <text x="920" y="455" font-family="sans-serif" fill="#BABAC1">int</text>

                    <text x="920" y="475" font-family="sans-serif" fill="#BABAC1">varchar(64)</text>

                    <svg x="48" y="492" enable-background="new 0 0 500 500" height="15px" version="1.1" viewBox="0 0 500 500" width="15px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path clip-rule="evenodd" d="M56.629,379.2c-14.09,14.071-14.09,36.975,0,51.055  c14.08,14.087,36.981,14.087,50.965,0l10.177-10.08l42.438,42.428c7.257,7.268,18.888,7.268,26.155,0l63.244-63.244  c7.268-7.255,7.268-18.89,0-26.157l-42.429-42.427l75.586-75.682c16.174,8.357,34.61,13.075,54.059,13.075  c65.234,0,118.111-52.869,118.111-118.109c0-65.232-52.877-118.111-118.111-118.111c-65.238,0-118.11,52.879-118.11,118.111  c0,19.449,4.721,37.886,13.077,54.06L56.629,379.2z M291.396,150.059c0-25.075,20.354-45.429,45.427-45.429  c25.076,0,45.426,20.354,45.426,45.429s-20.35,45.426-45.426,45.426C311.751,195.485,291.396,175.133,291.396,150.059z" fill="#AAA" fill-rule="evenodd"/></svg>

                    <svg x="400" y="332" enable-background="new 0 0 500 500" height="15px" version="1.1" viewBox="0 0 500 500" width="15px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path clip-rule="evenodd" d="M56.629,379.2c-14.09,14.071-14.09,36.975,0,51.055  c14.08,14.087,36.981,14.087,50.965,0l10.177-10.08l42.438,42.428c7.257,7.268,18.888,7.268,26.155,0l63.244-63.244  c7.268-7.255,7.268-18.89,0-26.157l-42.429-42.427l75.586-75.682c16.174,8.357,34.61,13.075,54.059,13.075  c65.234,0,118.111-52.869,118.111-118.109c0-65.232-52.877-118.111-118.111-118.111c-65.238,0-118.11,52.879-118.11,118.111  c0,19.449,4.721,37.886,13.077,54.06L56.629,379.2z M291.396,150.059c0-25.075,20.354-45.429,45.427-45.429  c25.076,0,45.426,20.354,45.426,45.429s-20.35,45.426-45.426,45.426C311.751,195.485,291.396,175.133,291.396,150.059z" fill="#AAA" fill-rule="evenodd"/></svg>

                    <svg x="48" y="532" enable-background="new 0 0 500 500" height="15px" version="1.1" viewBox="0 0 500 500" width="15px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path clip-rule="evenodd" d="M56.629,379.2c-14.09,14.071-14.09,36.975,0,51.055  c14.08,14.087,36.981,14.087,50.965,0l10.177-10.08l42.438,42.428c7.257,7.268,18.888,7.268,26.155,0l63.244-63.244  c7.268-7.255,7.268-18.89,0-26.157l-42.429-42.427l75.586-75.682c16.174,8.357,34.61,13.075,54.059,13.075  c65.234,0,118.111-52.869,118.111-118.109c0-65.232-52.877-118.111-118.111-118.111c-65.238,0-118.11,52.879-118.11,118.111  c0,19.449,4.721,37.886,13.077,54.06L56.629,379.2z M291.396,150.059c0-25.075,20.354-45.429,45.427-45.429  c25.076,0,45.426,20.354,45.426,45.429s-20.35,45.426-45.426,45.426C311.751,195.485,291.396,175.133,291.396,150.059z" fill="#FFD700" fill-rule="evenodd"/></svg>


                    <svg x="400" y="372" enable-background="new 0 0 500 500" height="15px" version="1.1" viewBox="0 0 500 500" width="15px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path clip-rule="evenodd" d="M56.629,379.2c-14.09,14.071-14.09,36.975,0,51.055  c14.08,14.087,36.981,14.087,50.965,0l10.177-10.08l42.438,42.428c7.257,7.268,18.888,7.268,26.155,0l63.244-63.244  c7.268-7.255,7.268-18.89,0-26.157l-42.429-42.427l75.586-75.682c16.174,8.357,34.61,13.075,54.059,13.075  c65.234,0,118.111-52.869,118.111-118.109c0-65.232-52.877-118.111-118.111-118.111c-65.238,0-118.11,52.879-118.11,118.111  c0,19.449,4.721,37.886,13.077,54.06L56.629,379.2z M291.396,150.059c0-25.075,20.354-45.429,45.427-45.429  c25.076,0,45.426,20.354,45.426,45.429s-20.35,45.426-45.426,45.426C311.751,195.485,291.396,175.133,291.396,150.059z" fill="#FFD700" fill-rule="evenodd"/></svg>

                    <svg x="760" y="442" enable-background="new 0 0 500 500" height="15px" version="1.1" viewBox="0 0 500 500" width="15px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path clip-rule="evenodd" d="M56.629,379.2c-14.09,14.071-14.09,36.975,0,51.055  c14.08,14.087,36.981,14.087,50.965,0l10.177-10.08l42.438,42.428c7.257,7.268,18.888,7.268,26.155,0l63.244-63.244  c7.268-7.255,7.268-18.89,0-26.157l-42.429-42.427l75.586-75.682c16.174,8.357,34.61,13.075,54.059,13.075  c65.234,0,118.111-52.869,118.111-118.109c0-65.232-52.877-118.111-118.111-118.111c-65.238,0-118.11,52.879-118.11,118.111  c0,19.449,4.721,37.886,13.077,54.06L56.629,379.2z M291.396,150.059c0-25.075,20.354-45.429,45.427-45.429  c25.076,0,45.426,20.354,45.426,45.429s-20.35,45.426-45.426,45.426C311.751,195.485,291.396,175.133,291.396,150.059z" fill="#AAA" fill-rule="evenodd"/></svg>

                    <polygon points="190,430 180,449 200,449" style="fill:#FFF;" />
                    <polygon points="710,360 691,350 691,370" style="fill:#FFF;" />-->
                </g>
            </svg>
        </svg>


    </div>
    <script src="../javascript/svg-transforms.js"></script>
    <script src="../javascript/svg-zoom.js"></script>
    <script src="../javascript/svg-export.js"></script>
    <script type="module" src="../javascript/createTablePopup.js"></script>
    <script type="module" src="../javascript/buttonsFunctionality.js"></script>
    <script type="module" src="../javascript/displayWindows.js"></script>
    <script type="module" src="../javascript/script.js"></script>
    <script type="module" src="../javascript/importSql.js"></script>
    <input type="file" id="real-file" accept="text/plain" hidden="hidden" />
</body>

</html>